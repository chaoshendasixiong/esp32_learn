# i2c 驱动 oled 屏幕

## IIC总线

串行 半双工 同步 近距离(抗干扰能力弱) 低速通信(可以用gpio来模拟) 适合同一电路板上芯片之间通信 

2根数据线 SDA 收发数据 SCL 同步时钟信号(波特率1bps 每秒传输1位)

多主多从结构(从设备都有地址7bit 主设备没有) 总线仲裁防止冲突 同一时间只有1个主机 

1. 主机发起通信(发送起始信号启用总线)
2. 主机发送一个字节数据(7bit地址1bit发送接收方向)
3. 其余从机收到 目标从机回复应答信号
4. 发送器发送1个字节数据 (防止硬件时钟累积误差 限制每次1个字节)
5. 接收器回复应答信号
6. 主机结束通信(发送停止信号释放总线)

## ssd1306

使用 esp8266 i2c 来操作 这个发光二极管点阵图形 其它型号还有3/4线SPI串口 8线并口6800/8080

查看板子背后有2个地址 0x78 0x7A 有个电阻焊接位置指定使用哪个 转成7bit就是0x3c 0x3d

理论上一个单片机能接2个屏幕

esp8266的IIC接口功能是使用gpio来模拟的 

### 通信格式

1：command 配置vcc，com，seg，display等适应不同的屏幕型号 必须在使用开始来初始化

格式包括1字节的命令本身和0或者多个命令参数 写到命令寄存器

2：data 芯片内部有个DRAM-GDDRAM，对应屏幕上的每一个像素 写到数据寄存器

**注意每个字节都要先发控制字节**

0x00 -> one command 

0x40 -> one data byte 

### 初始配置

连线信息

寻址RAM

滚动配置

RAM数据

### 命令列表

#### 基本配置

0x81 设置对比度  参数A[7:0] 复位后寄存器自动设7f

0xA4 设置 GDDRAM 内容显示 0xA4 复位后寄存器的默认值

0xA5 设置强制显示 不管 GDDRAM 相当于屏幕全白 

0xA6 设置屏幕正常显示模式 RAM: 0不显示 1显示 复位后寄存器的默认值

0xA7 设置屏幕反白模式 RAM：1不显示 0显示 

0xAE 设置屏幕不显示 复位后寄存器的默认值

0xAF 设置屏幕显示

#### 滚动配置

0x26/0x27 设置水平连续滚动 方向是右/左 6个参数

​		A[7:0]	填充字节 00,  B[2:0]	定义开始的页地址 0~7

​		C[2:0]	设置每帧的滚动时间间隔 

​			    000b-5frames 001b-64frames 010b-128frames 011b-256 frames

​				100b-3frames 101b-4frames 110b-25frames 111b-2frames

​		D[2:0]	定义结束的页地址 0~7

​		E[7:0]	填充字节 00， F[7:0]	填充字节 FF

0x29/2A 设置垂直连续滚动 方向是右/左 水平滚动1列   5个参数

​		A[2:0] 填充字节 B[2:0] 起始地址 0~7

​        C[2:0] 帧率 同上 D[2:0] 结束地址 0~7 E[5:0] 竖直滚动偏移

0x2E/2F 滚动开关  关掉滚动后要重写RMA数据

0xA3 设置垂直滚动区域 2个参数 

​			A[5:0] 设置顶部固定区域的行数。 顶部固定区域的行数以 GDDRAM 顶部（即第 0 行）为参考。 [RESET = 0]

​            B[6:0] 设置滚动区域的行数。 这是用于垂直滚动的行数。 滚动区域从顶部固定区域下方的第一行开始。 [RESET = 64]

#### 寻址配置

0x00~0F 页寻址模式下设置列开始地址的低4位 复位后寄存器自动设0

0x10~1F 页寻址模式下设置列开始地址的高4位 复位后寄存器自动设0

0x20 设置RAM寻址模式 参数A[1:0] 00水平、01竖直、10页、11无效，四种 复位默认页模式

0x21 设置列或者行寻址模式下的起始和结束的列地址 2个参数 A[6:0]B[6:0] 复位默认是0~127

0x22 设置列或者行寻址模式下的起始和结束的页地址 2个参数 A[2:0]B[2:0] 复位默认是0~7

0xB0~B7 设置页寻址模式下的起始页 刚好8页

LED布线 硬件配置 x和y轴的翻转看使用配置习惯排针在上则xy翻转下就好了

0x40~7F 设置显示起始行 复位默认是0 刚好64

0xA0/A1 设置列和段映射关系 A0是0->SEG0 A1是127~SEG0 x方向上的翻转

0xC0/C8 设置com电压输出扫描方向  y方向上的翻转

0xA8 设置多路复用率 参数A[5:0] 15~63  复位默认是63 height-1

0xD3 设置显示偏移 参数A[5:0] 图像竖直向上偏移 复位默认是0

0xDA 设置com引脚硬件配置 参数A[5:4]  [0,0,A5，A4,0,0,1,0] 

​		A[4] = 0 顺序com引脚配置 A[4] = 1 备用引脚配置

​		A[5] = 0 复位默认  禁止com左右映射 A[5] = 1 开启com左右映射

#### 其它配置

0xD5 设置时钟倍频和振荡频率 A[7:0] 高位振荡频率  低位分频，复位0x80

0xD9 设置预充电周期 A[7:0] 同步亮度的，复位是0x22

0xDB 设置COM的反压 A[6:4] 复位是0x20

0xE3 空指令

0x8D 电荷泵设置  A[2] 复位是0B，启用电荷泵0x14  电压来对显示器中的液晶进行编程  必须试用以下命令 0x8D 0x14 0xAF

#### DDRAM



